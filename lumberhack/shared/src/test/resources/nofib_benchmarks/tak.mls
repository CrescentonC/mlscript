:NewParser
:ParseOnly

:lhInHaskell
:lhGenOCaml
tak x y z = if not(y < x) then z
       else tak (tak (x-1) y z) (tak (y-1) z x) (tak (z-1) x y)
testTak_nofib n = tak 31 16 8
testTak_nofib $ primId 0
//│ ||
//│ Parsed: {}
//│ >>>>>>>>>> Original >>>>>>>>>>
//│ testTak_nofib_lh_₁^58(primId⁰(0))
//│ def tak_lh_₁(_lh_tak_arg1⁰, _lh_tak_arg2⁰, _lh_tak_arg3⁰) = if not⁰((_lh_tak_arg2⁰ < _lh_tak_arg1⁰)) then _lh_tak_arg3⁰ else tak_lh_₁^9(tak_lh_₁^10((_lh_tak_arg1⁰ - 1), _lh_tak_arg2⁰, _lh_tak_arg3⁰), tak_lh_₁^22((_lh_tak_arg2⁰ - 1), _lh_tak_arg3⁰, _lh_tak_arg1⁰), tak_lh_₁^34((_lh_tak_arg3⁰ - 1), _lh_tak_arg1⁰, _lh_tak_arg2⁰))
//│ def testTak_nofib_lh_₁(_lh_testTak_nofib_arg1⁰) = tak_lh_₁^50(31, 16, 8)
//│ 		---------- unoptimized ocaml gen ----------
//│ 		let rec tak_lh__d1 _lh_tak_arg1_0 _lh_tak_arg2_0 _lh_tak_arg3_0 =
//│ 		  (if (not (_lh_tak_arg2_0 < _lh_tak_arg1_0)) then
//│ 		    _lh_tak_arg3_0
//│ 		  else
//│ 		    (((tak_lh__d1 (((tak_lh__d1 (_lh_tak_arg1_0 - 1)) _lh_tak_arg2_0) _lh_tak_arg3_0)) (((tak_lh__d1 (_lh_tak_arg2_0 - 1)) _lh_tak_arg3_0) _lh_tak_arg1_0)) (((tak_lh__d1 (_lh_tak_arg3_0 - 1)) _lh_tak_arg1_0) _lh_tak_arg2_0)));;
//│ 		let rec testTak_nofib_lh__d1 _lh_testTak_nofib_arg1_0 =
//│ 		  (((tak_lh__d1 31) 16) 8);;
//│ 		(testTak_nofib_lh__d1 0)
//│ 		---------- unoptimized ocaml gen ----------
//│ <<<<<<<<<< Original <<<<<<<<<<
//│ 
//│ >>>>>>> fusion matches >>>>>>>
//│ 
//│ ------------------
//│ 
//│ <<<<<<< fusion matches <<<<<<<
//│ 
//│ >>>>>>> new fusion strategy >>>>>>>
//│ 
//│ ------------------
//│ 
//│ <<<<<<< new fusion strategy <<<<<<<
//│ 
//│ >>>>>>> after fusion >>>>>>>
//│ testTak_nofib_lh_₁(primId⁰(0))
//│ def tak_lh_₁(_lh_tak_arg1¹, _lh_tak_arg2¹, _lh_tak_arg3¹) = if not⁰((_lh_tak_arg2¹ < _lh_tak_arg1¹)) then _lh_tak_arg3¹ else tak_lh_₁(tak_lh_₁((_lh_tak_arg1¹ - 1), _lh_tak_arg2¹, _lh_tak_arg3¹), tak_lh_₁((_lh_tak_arg2¹ - 1), _lh_tak_arg3¹, _lh_tak_arg1¹), tak_lh_₁((_lh_tak_arg3¹ - 1), _lh_tak_arg1¹, _lh_tak_arg2¹))
//│ def testTak_nofib_lh_₁(_lh_testTak_nofib_arg1¹) = tak_lh_₁(31, 16, 8)
//│ <<<<<<< after fusion <<<<<<<
//│ 
//│ >>>>>>>>>> Generated OCaml >>>>>>>>>>
//│ benchmark file generated
//│ <<<<<<<<<< Generated OCaml <<<<<<<<<<
