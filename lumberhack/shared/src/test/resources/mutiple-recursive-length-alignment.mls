:NewParser
:ParseOnly

// CORRECT: p1 and c are aligned, and p2 and c is not algned
// WRONG: example for merging the alpha-equiv strategies being difficult
let p1 = C(C(p1))
let p2 = D(D(D(p2)))
fun c(x) = if x is
  C(aa) then if aa is
    C(a2) then if a2 is
      C(a3) then y => if y is
        D(bb) then if bb is
          D(cc) then c(a3)(cc)
c(p1)(p2)
//│ |#let| |p1| |#=| |C|(|C|(|p1|)|)|↵|#let| |p2| |#=| |D|(|D|(|D|(|p2|)|)|)|↵|#fun| |c|(|x|)| |#=| |#if| |x| |is|→|C|(|aa|)| |#then| |#if| |aa| |is|→|C|(|a2|)| |#then| |#if| |a2| |is|→|C|(|a3|)| |#then| |y| |=>| |#if| |y| |is|→|D|(|bb|)| |#then| |#if| |bb| |is|→|D|(|cc|)| |#then| |c|(|a3|)|(|cc|)|←|←|←|←|←|↵|c|(|p1|)|(|p2|)|
//│ Parsed: {let p1 = C (C (p1,),); let p2 = D (D (D (p2,),),); fun c = x, => if x is ‹(C (aa,)) then if aa is ‹(C (a2,)) then if a2 is ‹(C (a3,)) then y, => if y is ‹(D (bb,)) then if bb is ‹(D (cc,)) then c (a3,) (cc,)›››››; c (p1,) (p2,)}
//│ >>>>>>>>>> Original >>>>>>>>>>
//│ c^25(p1^26, p2^28)
//│ def c(x⁰) = case x⁰ of {
//│ 	C aa⁰ => case aa⁰ of {
//│ 		C a2⁰ => case a2⁰ of {
//│ 			C a3⁰ => (fun y⁰ -> case y⁰ of {
//│ 				D bb⁰ => case bb⁰ of {
//│ 					D cc⁰ => c^13(a3⁰, cc⁰)}})}}}
//│ def p1 = [C [C p1^1]]
//│ def p2 = [D [D [D p2^4]]]
//│ <<<<<<<<<< Original <<<<<<<<<<
//│ 
//│ >>>>>>> expansion >>>>>>>
//│ [c^25]
//│ 	[c^25 · c^13]
//│ 		[c^25 · c^13 · c^13] ---> [c^25] (only one)
//│ [p1^26]
//│ 	[p1^26 · p1^1]
//│ 		[p1^26 · p1^1 · p1^1]
//│ 			[p1^26 · p1^1 · p1^1 · p1^1] ---> [p1^26] (only one)
//│ [p2^28]
//│ 	[p2^28 · p2^4]
//│ 		[p2^28 · p2^4 · p2^4] ---> [p2^28] (only one)
//│ <<<<<<< expansion <<<<<<<
//│ 
//│ >>>>>>> expanded program >>>>>>>
//│ c_₀(p1_₀, p2_₀)
//│ def c_₀(x¹) = 
//│ 	case x¹ of {
//│ 		C aa¹ => case aa¹ of {
//│ 			C a2¹ => case a2¹ of {
//│ 				C a3¹ => (fun y¹ -> case y¹ of {
//│ 					D bb¹ => case bb¹ of {
//│ 						D cc¹ => c_₁(a3¹, cc¹)}})}}}
//│ 	where
//│ 	def c_₁(x²) = 
//│ 		case x² of {
//│ 			C aa² => case aa² of {
//│ 				C a2² => case a2² of {
//│ 					C a3² => (fun y² -> case y² of {
//│ 						D bb² => case bb² of {
//│ 							D cc² => c_₀(a3², cc²)}})}}}
//│ def p1_₀ = 
//│ 	[C [C p1_₁]]
//│ 	where
//│ 	def p1_₁ = 
//│ 		[C [C p1_₂]]
//│ 		where
//│ 		def p1_₂ = 
//│ 			[C [C p1_₀]]
//│ def p2_₀ = 
//│ 	[D [D [D p2_₁]]]
//│ 	where
//│ 	def p2_₁ = 
//│ 		[D [D [D p2_₀]]]
//│ <<<<<<< expanded program <<<<<<<
//│ 
//│ >>>>>>> fusion matches >>>>>>>
//│ [D p2_₀]: 31 --->
//│ 	case bb¹ of {D cc¹ => c_₁(a3¹, cc¹)}: 51
//│ 	case bb² of {D cc² => c_₀(a3², cc²)}: 68
//│ [D [D p2_₀]]: 32 --->
//│ 	case y¹ of {D bb¹ => case bb¹ of {D cc¹ => c_₁(a3¹, cc¹)}}: 52
//│ 	case y² of {D bb² => case bb² of {D cc² => c_₀(a3², cc²)}}: 69
//│ [D [D [D p2_₀]]]: 33 --->
//│ 	case bb¹ of {D cc¹ => c_₁(a3¹, cc¹)}: 51
//│ 	case bb² of {D cc² => c_₀(a3², cc²)}: 68
//│ [C p1_₁]: 35 --->
//│ 	case aa¹ of {C a2¹ => case a2¹ of {C a3¹ => (fun y¹ -> case y¹ of {D bb¹ => case bb¹ of {D cc¹ => c_₁(a3¹, cc¹)}})}}: 55
//│ [C [C p1_₁]]: 36 --->
//│ 	case x¹ of {C aa¹ => case aa¹ of {C a2¹ => case a2¹ of {C a3¹ => (fun y¹ -> case y¹ of {D bb¹ => case bb¹ of {D cc¹ => c_₁(a3¹, cc¹)}})}}}: 56
//│ [D p2_₁]: 38 --->
//│ 	case y¹ of {D bb¹ => case bb¹ of {D cc¹ => c_₁(a3¹, cc¹)}}: 52
//│ 	case y² of {D bb² => case bb² of {D cc² => c_₀(a3², cc²)}}: 69
//│ [D [D p2_₁]]: 39 --->
//│ 	case bb¹ of {D cc¹ => c_₁(a3¹, cc¹)}: 51
//│ 	case bb² of {D cc² => c_₀(a3², cc²)}: 68
//│ [D [D [D p2_₁]]]: 40 --->
//│ 	case y¹ of {D bb¹ => case bb¹ of {D cc¹ => c_₁(a3¹, cc¹)}}: 52
//│ 	case y² of {D bb² => case bb² of {D cc² => c_₀(a3², cc²)}}: 69
//│ [C p1_₀]: 76 --->
//│ 	case a2² of {C a3² => (fun y² -> case y² of {D bb² => case bb² of {D cc² => c_₀(a3², cc²)}})}: 71
//│ [C [C p1_₀]]: 77 --->
//│ 	case aa² of {C a2² => case a2² of {C a3² => (fun y² -> case y² of {D bb² => case bb² of {D cc² => c_₀(a3², cc²)}})}}: 72
//│ [C p1_₂]: 79 --->
//│ 	case x² of {C aa² => case aa² of {C a2² => case a2² of {C a3² => (fun y² -> case y² of {D bb² => case bb² of {D cc² => c_₀(a3², cc²)}})}}}: 73
//│ [C [C p1_₂]]: 80 --->
//│ 	case a2¹ of {C a3¹ => (fun y¹ -> case y¹ of {D bb¹ => case bb¹ of {D cc¹ => c_₁(a3¹, cc¹)}})}: 54
//│ ------------------
//│ case bb¹ of {D cc¹ => c_₁(a3¹, cc¹)}: 51 --->
//│ 	[D p2_₀]: 31
//│ 	[D [D [D p2_₀]]]: 33
//│ 	[D [D p2_₁]]: 39
//│ case y¹ of {D bb¹ => case bb¹ of {D cc¹ => c_₁(a3¹, cc¹)}}: 52 --->
//│ 	[D [D p2_₀]]: 32
//│ 	[D p2_₁]: 38
//│ 	[D [D [D p2_₁]]]: 40
//│ case a2¹ of {C a3¹ => (fun y¹ -> case y¹ of {D bb¹ => case bb¹ of {D cc¹ => c_₁(a3¹, cc¹)}})}: 54 --->
//│ 	[C [C p1_₂]]: 80
//│ case aa¹ of {C a2¹ => case a2¹ of {C a3¹ => (fun y¹ -> case y¹ of {D bb¹ => case bb¹ of {D cc¹ => c_₁(a3¹, cc¹)}})}}: 55 --->
//│ 	[C p1_₁]: 35
//│ case x¹ of {C aa¹ => case aa¹ of {C a2¹ => case a2¹ of {C a3¹ => (fun y¹ -> case y¹ of {D bb¹ => case bb¹ of {D cc¹ => c_₁(a3¹, cc¹)}})}}}: 56 --->
//│ 	[C [C p1_₁]]: 36
//│ case bb² of {D cc² => c_₀(a3², cc²)}: 68 --->
//│ 	[D p2_₀]: 31
//│ 	[D [D [D p2_₀]]]: 33
//│ 	[D [D p2_₁]]: 39
//│ case y² of {D bb² => case bb² of {D cc² => c_₀(a3², cc²)}}: 69 --->
//│ 	[D [D p2_₀]]: 32
//│ 	[D p2_₁]: 38
//│ 	[D [D [D p2_₁]]]: 40
//│ case a2² of {C a3² => (fun y² -> case y² of {D bb² => case bb² of {D cc² => c_₀(a3², cc²)}})}: 71 --->
//│ 	[C p1_₀]: 76
//│ case aa² of {C a2² => case a2² of {C a3² => (fun y² -> case y² of {D bb² => case bb² of {D cc² => c_₀(a3², cc²)}})}}: 72 --->
//│ 	[C [C p1_₀]]: 77
//│ case x² of {C aa² => case aa² of {C a2² => case a2² of {C a3² => (fun y² -> case y² of {D bb² => case bb² of {D cc² => c_₀(a3², cc²)}})}}}: 73 --->
//│ 	[C p1_₂]: 79
//│ <<<<<<< fusion matches <<<<<<<
//│ 
//│ >>>>>>> new fusion strategy >>>>>>>
//│ [C p1_₁]: 35 --->
//│ 	case aa¹ of {C a2¹ => case a2¹ of {C a3¹ => (fun y¹ -> case y¹ of {D bb¹ => case bb¹ of {D cc¹ => c_₁(a3¹, cc¹)}})}}: 55
//│ [C [C p1_₁]]: 36 --->
//│ 	case x¹ of {C aa¹ => case aa¹ of {C a2¹ => case a2¹ of {C a3¹ => (fun y¹ -> case y¹ of {D bb¹ => case bb¹ of {D cc¹ => c_₁(a3¹, cc¹)}})}}}: 56
//│ [C p1_₀]: 76 --->
//│ 	case a2² of {C a3² => (fun y² -> case y² of {D bb² => case bb² of {D cc² => c_₀(a3², cc²)}})}: 71
//│ [C [C p1_₀]]: 77 --->
//│ 	case aa² of {C a2² => case a2² of {C a3² => (fun y² -> case y² of {D bb² => case bb² of {D cc² => c_₀(a3², cc²)}})}}: 72
//│ [C p1_₂]: 79 --->
//│ 	case x² of {C aa² => case aa² of {C a2² => case a2² of {C a3² => (fun y² -> case y² of {D bb² => case bb² of {D cc² => c_₀(a3², cc²)}})}}}: 73
//│ [C [C p1_₂]]: 80 --->
//│ 	case a2¹ of {C a3¹ => (fun y¹ -> case y¹ of {D bb¹ => case bb¹ of {D cc¹ => c_₁(a3¹, cc¹)}})}: 54
//│ ------------------
//│ case a2¹ of {C a3¹ => (fun y¹ -> case y¹ of {D bb¹ => case bb¹ of {D cc¹ => c_₁(a3¹, cc¹)}})}: 54 --->
//│ 	[C [C p1_₂]]: 80
//│ case aa¹ of {C a2¹ => case a2¹ of {C a3¹ => (fun y¹ -> case y¹ of {D bb¹ => case bb¹ of {D cc¹ => c_₁(a3¹, cc¹)}})}}: 55 --->
//│ 	[C p1_₁]: 35
//│ case x¹ of {C aa¹ => case aa¹ of {C a2¹ => case a2¹ of {C a3¹ => (fun y¹ -> case y¹ of {D bb¹ => case bb¹ of {D cc¹ => c_₁(a3¹, cc¹)}})}}}: 56 --->
//│ 	[C [C p1_₁]]: 36
//│ case a2² of {C a3² => (fun y² -> case y² of {D bb² => case bb² of {D cc² => c_₀(a3², cc²)}})}: 71 --->
//│ 	[C p1_₀]: 76
//│ case aa² of {C a2² => case a2² of {C a3² => (fun y² -> case y² of {D bb² => case bb² of {D cc² => c_₀(a3², cc²)}})}}: 72 --->
//│ 	[C [C p1_₀]]: 77
//│ case x² of {C aa² => case aa² of {C a2² => case a2² of {C a3² => (fun y² -> case y² of {D bb² => case bb² of {D cc² => c_₀(a3², cc²)}})}}}: 73 --->
//│ 	[C p1_₂]: 79
//│ <<<<<<< new fusion strategy <<<<<<<
//│ 
//│ >>>>>>> after fusion >>>>>>>
//│ c_₀(p1_₀, p2_₀)
//│ def c_₀(x⁴) = 
//│ 	x⁴
//│ 	where
//│ 	def c_₁(x³) = 
//│ 		x³
//│ def p1_₀ = 
//│ 	let aa⁴ = 	
//│ 		let a2⁴ = p1_₁
//│ 		in a2⁴
//│ 	in aa⁴
//│ 	where
//│ 	def p1_₁ = 
//│ 		let a3⁴ = 	
//│ 			let aa³ = p1_₂
//│ 			in aa³
//│ 		in (fun y⁴ -> case y⁴ of {
//│ 			D bb¹ => case bb¹ of {
//│ 				D cc¹ => c_₁(a3⁴, cc¹)}})
//│ 		where
//│ 		def p1_₂ = 
//│ 			let a2³ = 	
//│ 				let a3³ = p1_₀
//│ 				in (fun y³ -> case y³ of {
//│ 					D bb² => case bb² of {
//│ 						D cc² => c_₀(a3³, cc²)}})
//│ 			in a2³
//│ def p2_₀ = 
//│ 	[D [D [D p2_₁]]]
//│ 	where
//│ 	def p2_₁ = 
//│ 		[D [D [D p2_₀]]]
//│ <<<<<<< after fusion <<<<<<<

// WRONG: manually do the fusion on top of the previous fusion result, since `c0` is used twice, it is wrong
fun c0(x) = x
fun c1(x) = x
let p10 = p11
fun p11(y) = if y is
  D(bb) then if bb is
    D(cc) then c1(p12)(cc)
fun p12(y) = if y is
  D(bb) then if bb is
    D(cc) then c0(p10)(cc)
let p20 = D(D(D(p21)))
let p21 = D(D(D(p20)))
c0(p10)(p20)
//│ |#fun| |c0|(|x|)| |#=| |x|↵|#fun| |c1|(|x|)| |#=| |x|↵|#let| |p10| |#=| |p11|↵|#fun| |p11|(|y|)| |#=| |#if| |y| |is|→|D|(|bb|)| |#then| |#if| |bb| |is|→|D|(|cc|)| |#then| |c1|(|p12|)|(|cc|)|←|←|↵|#fun| |p12|(|y|)| |#=| |#if| |y| |is|→|D|(|bb|)| |#then| |#if| |bb| |is|→|D|(|cc|)| |#then| |c0|(|p10|)|(|cc|)|←|←|↵|#let| |p20| |#=| |D|(|D|(|D|(|p21|)|)|)|↵|#let| |p21| |#=| |D|(|D|(|D|(|p20|)|)|)|↵|c0|(|p10|)|(|p20|)|
//│ Parsed: {fun c0 = x, => x; fun c1 = x, => x; let p10 = p11; fun p11 = y, => if y is ‹(D (bb,)) then if bb is ‹(D (cc,)) then c1 (p12,) (cc,)››; fun p12 = y, => if y is ‹(D (bb,)) then if bb is ‹(D (cc,)) then c0 (p10,) (cc,)››; let p20 = D (D (D (p21,),),); let p21 = D (D (D (p20,),),); c0 (p10,) (p20,)}
//│ >>>>>>>>>> Original >>>>>>>>>>
//│ c0^34(p10^35, p20^37)
//│ def c0(x⁰) = x⁰
//│ def c1(x¹) = x¹
//│ def p10 = p11^5
//│ def p11(y⁰) = case y⁰ of {
//│ 	D bb⁰ => case bb⁰ of {
//│ 		D cc⁰ => c1^8(p12^9, cc⁰)}}
//│ def p12(y¹) = case y¹ of {
//│ 	D bb¹ => case bb¹ of {
//│ 		D cc¹ => c0^18(p10^19, cc¹)}}
//│ def p20 = [D [D [D p21^26]]]
//│ def p21 = [D [D [D p20^30]]]
//│ <<<<<<<<<< Original <<<<<<<<<<
//│ 
//│ >>>>>>> expansion >>>>>>>
//│ [c0^34] (hopeless to continue)
//│ [p10^35] (hopeless to continue)
//│ 	[p10^35 · p11^5] (using original def)
//│ 		[p10^35 · p11^5 · c1^8] (using original def)
//│ 		[p10^35 · p11^5 · p12^9] (using original def)
//│ 			[p10^35 · p11^5 · p12^9 · c0^18] (using original def)
//│ 			[p10^35 · p11^5 · p12^9 · p10^19] ---> [p10^35] (using original def)
//│ [p20^37] (hopeless to continue)
//│ 	[p20^37 · p21^26] (using original def)
//│ 		[p20^37 · p21^26 · p20^30] ---> [p20^37] (using original def)
//│ <<<<<<< expansion <<<<<<<
//│ 
//│ >>>>>>> expanded program >>>>>>>
//│ c0_₀(p10_₀, p20_₀)
//│ def c0_₀(x³) = 
//│ 	x³
//│ def p10_₀ = 
//│ 	p11_₀
//│ 	where
//│ 	def p11_₀(y³) = 
//│ 		case y³ of {
//│ 			D bb³ => case bb³ of {
//│ 				D cc³ => c1_₀(p12_₀, cc³)}}
//│ 		where
//│ 		def c1_₀(x⁴) = 
//│ 			x⁴
//│ 		def p12_₀(y²) = 
//│ 			case y² of {
//│ 				D bb² => case bb² of {
//│ 					D cc² => c0_₁(p10_₀, cc²)}}
//│ 			where
//│ 			def c0_₁(x²) = 
//│ 				x²
//│ def p20_₀ = 
//│ 	[D [D [D p21_₀]]]
//│ 	where
//│ 	def p21_₀ = 
//│ 		[D [D [D p20_₀]]]
//│ <<<<<<< expanded program <<<<<<<
//│ 
//│ >>>>>>> fusion matches >>>>>>>
//│ [D p20_₀]: 64 --->
//│ 	case bb² of {D cc² => c0_₁(p10_₀, cc²)}: 46
//│ 	case bb³ of {D cc³ => c1_₀(p12_₀, cc³)}: 60
//│ [D [D p20_₀]]: 65 --->
//│ 	case y² of {D bb² => case bb² of {D cc² => c0_₁(p10_₀, cc²)}}: 47
//│ 	case y³ of {D bb³ => case bb³ of {D cc³ => c1_₀(p12_₀, cc³)}}: 61
//│ [D [D [D p20_₀]]]: 66 --->
//│ 	case bb² of {D cc² => c0_₁(p10_₀, cc²)}: 46
//│ 	case bb³ of {D cc³ => c1_₀(p12_₀, cc³)}: 60
//│ [D p21_₀]: 71 --->
//│ 	case y² of {D bb² => case bb² of {D cc² => c0_₁(p10_₀, cc²)}}: 47
//│ 	case y³ of {D bb³ => case bb³ of {D cc³ => c1_₀(p12_₀, cc³)}}: 61
//│ [D [D p21_₀]]: 72 --->
//│ 	case bb² of {D cc² => c0_₁(p10_₀, cc²)}: 46
//│ 	case bb³ of {D cc³ => c1_₀(p12_₀, cc³)}: 60
//│ [D [D [D p21_₀]]]: 73 --->
//│ 	case y² of {D bb² => case bb² of {D cc² => c0_₁(p10_₀, cc²)}}: 47
//│ 	case y³ of {D bb³ => case bb³ of {D cc³ => c1_₀(p12_₀, cc³)}}: 61
//│ ------------------
//│ case bb² of {D cc² => c0_₁(p10_₀, cc²)}: 46 --->
//│ 	[D p20_₀]: 64
//│ 	[D [D [D p20_₀]]]: 66
//│ 	[D [D p21_₀]]: 72
//│ case y² of {D bb² => case bb² of {D cc² => c0_₁(p10_₀, cc²)}}: 47 --->
//│ 	[D [D p20_₀]]: 65
//│ 	[D p21_₀]: 71
//│ 	[D [D [D p21_₀]]]: 73
//│ case bb³ of {D cc³ => c1_₀(p12_₀, cc³)}: 60 --->
//│ 	[D p20_₀]: 64
//│ 	[D [D [D p20_₀]]]: 66
//│ 	[D [D p21_₀]]: 72
//│ case y³ of {D bb³ => case bb³ of {D cc³ => c1_₀(p12_₀, cc³)}}: 61 --->
//│ 	[D [D p20_₀]]: 65
//│ 	[D p21_₀]: 71
//│ 	[D [D [D p21_₀]]]: 73
//│ <<<<<<< fusion matches <<<<<<<
//│ 
//│ >>>>>>> new fusion strategy >>>>>>>
//│ 
//│ ------------------
//│ 
//│ <<<<<<< new fusion strategy <<<<<<<
//│ 
//│ >>>>>>> after fusion >>>>>>>
//│ c0_₀(p10_₀, p20_₀)
//│ def c0_₀(x⁷) = 
//│ 	x⁷
//│ def p10_₀ = 
//│ 	p11_₀
//│ 	where
//│ 	def p11_₀(y⁴) = 
//│ 		case y⁴ of {
//│ 			D bb³ => case bb³ of {
//│ 				D cc³ => c1_₀(p12_₀, cc³)}}
//│ 		where
//│ 		def c1_₀(x⁵) = 
//│ 			x⁵
//│ 		def p12_₀(y⁵) = 
//│ 			case y⁵ of {
//│ 				D bb² => case bb² of {
//│ 					D cc² => c0_₁(p10_₀, cc²)}}
//│ 			where
//│ 			def c0_₁(x⁶) = 
//│ 				x⁶
//│ def p20_₀ = 
//│ 	[D [D [D p21_₀]]]
//│ 	where
//│ 	def p21_₀ = 
//│ 		[D [D [D p20_₀]]]
//│ <<<<<<< after fusion <<<<<<<

// CORRECT: after duplicating the used-more-than-once `c0`, the result is correct
fun c0(x) = x
fun c1(x) = x
fun id(x) = x
let p10 = p11
fun p11(y) = if y is
  D(bb) then if bb is
    D(cc) then c1(p12)(cc)
fun p12(y) = if y is
  D(bb) then if bb is
    D(cc) then id(p10)(cc)
let p20 = D(D(D(p21)))
let p21 = D(D(D(p20)))
c0(p10)(p20)
//│ |#fun| |c0|(|x|)| |#=| |x|↵|#fun| |c1|(|x|)| |#=| |x|↵|#fun| |id|(|x|)| |#=| |x|↵|#let| |p10| |#=| |p11|↵|#fun| |p11|(|y|)| |#=| |#if| |y| |is|→|D|(|bb|)| |#then| |#if| |bb| |is|→|D|(|cc|)| |#then| |c1|(|p12|)|(|cc|)|←|←|↵|#fun| |p12|(|y|)| |#=| |#if| |y| |is|→|D|(|bb|)| |#then| |#if| |bb| |is|→|D|(|cc|)| |#then| |id|(|p10|)|(|cc|)|←|←|↵|#let| |p20| |#=| |D|(|D|(|D|(|p21|)|)|)|↵|#let| |p21| |#=| |D|(|D|(|D|(|p20|)|)|)|↵|c0|(|p10|)|(|p20|)|
//│ Parsed: {fun c0 = x, => x; fun c1 = x, => x; fun id = x, => x; let p10 = p11; fun p11 = y, => if y is ‹(D (bb,)) then if bb is ‹(D (cc,)) then c1 (p12,) (cc,)››; fun p12 = y, => if y is ‹(D (bb,)) then if bb is ‹(D (cc,)) then id (p10,) (cc,)››; let p20 = D (D (D (p21,),),); let p21 = D (D (D (p20,),),); c0 (p10,) (p20,)}
//│ >>>>>>>>>> Original >>>>>>>>>>
//│ c0^36(p10^37, p20^39)
//│ def c0(x⁰) = x⁰
//│ def c1(x¹) = x¹
//│ def id(x²) = x²
//│ def p10 = p11^7
//│ def p11(y⁰) = case y⁰ of {
//│ 	D bb⁰ => case bb⁰ of {
//│ 		D cc⁰ => c1^10(p12^11, cc⁰)}}
//│ def p12(y¹) = case y¹ of {
//│ 	D bb¹ => case bb¹ of {
//│ 		D cc¹ => id^20(p10^21, cc¹)}}
//│ def p20 = [D [D [D p21^28]]]
//│ def p21 = [D [D [D p20^32]]]
//│ <<<<<<<<<< Original <<<<<<<<<<
//│ 
//│ >>>>>>> expansion >>>>>>>
//│ [c0^36] (hopeless to continue)
//│ [p10^37]
//│ 	[p10^37 · p11^7]
//│ 		[p10^37 · p11^7 · c1^10] (hopeless to continue)
//│ 		[p10^37 · p11^7 · p12^11]
//│ 			[p10^37 · p11^7 · p12^11 · id^20] (hopeless to continue)
//│ 			[p10^37 · p11^7 · p12^11 · p10^21]
//│ 				[p10^37 · p11^7 · p12^11 · p10^21 · p11^7]
//│ 					[p10^37 · p11^7 · p12^11 · p10^21 · p11^7 · c1^10] (hopeless to continue)
//│ 					[p10^37 · p11^7 · p12^11 · p10^21 · p11^7 · p12^11]
//│ 						[p10^37 · p11^7 · p12^11 · p10^21 · p11^7 · p12^11 · id^20] (hopeless to continue)
//│ 						[p10^37 · p11^7 · p12^11 · p10^21 · p11^7 · p12^11 · p10^21]
//│ 							[p10^37 · p11^7 · p12^11 · p10^21 · p11^7 · p12^11 · p10^21 · p11^7]
//│ 								[p10^37 · p11^7 · p12^11 · p10^21 · p11^7 · p12^11 · p10^21 · p11^7 · c1^10] (hopeless to continue)
//│ 								[p10^37 · p11^7 · p12^11 · p10^21 · p11^7 · p12^11 · p10^21 · p11^7 · p12^11]
//│ 									[p10^37 · p11^7 · p12^11 · p10^21 · p11^7 · p12^11 · p10^21 · p11^7 · p12^11 · id^20] (hopeless to continue)
//│ 									[p10^37 · p11^7 · p12^11 · p10^21 · p11^7 · p12^11 · p10^21 · p11^7 · p12^11 · p10^21]
//│ 										[p10^37 · p11^7 · p12^11 · p10^21 · p11^7 · p12^11 · p10^21 · p11^7 · p12^11 · p10^21 · p11^7] ---> [p10^37 · p11^7] (only one)
//│ [p20^39]
//│ 	[p20^39 · p21^28]
//│ 		[p20^39 · p21^28 · p20^32]
//│ 			[p20^39 · p21^28 · p20^32 · p21^28]
//│ 				[p20^39 · p21^28 · p20^32 · p21^28 · p20^32] ---> [p20^39] (only one)
//│ <<<<<<< expansion <<<<<<<
//│ 
//│ >>>>>>> expanded program >>>>>>>
//│ c0_₀(p10_₀, p20_₀)
//│ def c0_₀(x⁵) = 
//│ 	x⁵
//│ def p10_₀ = 
//│ 	p11_₀
//│ 	where
//│ 	def p11_₀(y³) = 
//│ 		case y³ of {
//│ 			D bb³ => case bb³ of {
//│ 				D cc³ => c1_₀(p12_₀, cc³)}}
//│ 		where
//│ 		def c1_₀(x⁸) = 
//│ 			x⁸
//│ 		def p12_₀(y⁵) = 
//│ 			case y⁵ of {
//│ 				D bb⁵ => case bb⁵ of {
//│ 					D cc⁵ => id_₀(p10_₁, cc⁵)}}
//│ 			where
//│ 			def id_₀(x⁷) = 
//│ 				x⁷
//│ 			def p10_₁ = 
//│ 				p11_₁
//│ 				where
//│ 				def p11_₁(y⁷) = 
//│ 					case y⁷ of {
//│ 						D bb⁷ => case bb⁷ of {
//│ 							D cc⁷ => c1_₁(p12_₁, cc⁷)}}
//│ 					where
//│ 					def c1_₁(x³) = 
//│ 						x³
//│ 					def p12_₁(y⁶) = 
//│ 						case y⁶ of {
//│ 							D bb⁶ => case bb⁶ of {
//│ 								D cc⁶ => id_₁(p10_₂, cc⁶)}}
//│ 						where
//│ 						def id_₁(x⁶) = 
//│ 							x⁶
//│ 						def p10_₂ = 
//│ 							p11_₂
//│ 							where
//│ 							def p11_₂(y⁴) = 
//│ 								case y⁴ of {
//│ 									D bb⁴ => case bb⁴ of {
//│ 										D cc⁴ => c1_₂(p12_₂, cc⁴)}}
//│ 								where
//│ 								def c1_₂(x⁹) = 
//│ 									x⁹
//│ 								def p12_₂(y²) = 
//│ 									case y² of {
//│ 										D bb² => case bb² of {
//│ 											D cc² => id_₂(p10_₃, cc²)}}
//│ 									where
//│ 									def id_₂(x⁴) = 
//│ 										x⁴
//│ 									def p10_₃ = 
//│ 										p11_₀
//│ def p20_₀ = 
//│ 	[D [D [D p21_₀]]]
//│ 	where
//│ 	def p21_₀ = 
//│ 		[D [D [D p20_₁]]]
//│ 		where
//│ 		def p20_₁ = 
//│ 			[D [D [D p21_₁]]]
//│ 			where
//│ 			def p21_₁ = 
//│ 				[D [D [D p20_₀]]]
//│ <<<<<<< expanded program <<<<<<<
//│ 
//│ >>>>>>> fusion matches >>>>>>>
//│ [D p21_₁]: 90 --->
//│ 	case y⁴ of {D bb⁴ => case bb⁴ of {D cc⁴ => c1_₂(p12_₂, cc⁴)}}: 77
//│ [D [D p21_₁]]: 91 --->
//│ 	case bb⁶ of {D cc⁶ => id_₁(p10_₂, cc⁶)}: 109
//│ [D [D [D p21_₁]]]: 92 --->
//│ 	case y⁶ of {D bb⁶ => case bb⁶ of {D cc⁶ => id_₁(p10_₂, cc⁶)}}: 110
//│ [D p21_₀]: 95 --->
//│ 	case y⁵ of {D bb⁵ => case bb⁵ of {D cc⁵ => id_₀(p10_₁, cc⁵)}}: 87
//│ [D [D p21_₀]]: 96 --->
//│ 	case bb³ of {D cc³ => c1_₀(p12_₀, cc³)}: 62
//│ [D [D [D p21_₀]]]: 97 --->
//│ 	case y³ of {D bb³ => case bb³ of {D cc³ => c1_₀(p12_₀, cc³)}}: 63
//│ [D p20_₀]: 99 --->
//│ 	case bb² of {D cc² => id_₂(p10_₃, cc²)}: 50
//│ [D [D p20_₀]]: 100 --->
//│ 	case y² of {D bb² => case bb² of {D cc² => id_₂(p10_₃, cc²)}}: 51
//│ [D [D [D p20_₀]]]: 101 --->
//│ 	case bb⁴ of {D cc⁴ => c1_₂(p12_₂, cc⁴)}: 76
//│ [D p20_₁]: 126 --->
//│ 	case bb⁷ of {D cc⁷ => c1_₁(p12_₁, cc⁷)}: 121
//│ [D [D p20_₁]]: 127 --->
//│ 	case y⁷ of {D bb⁷ => case bb⁷ of {D cc⁷ => c1_₁(p12_₁, cc⁷)}}: 122
//│ [D [D [D p20_₁]]]: 128 --->
//│ 	case bb⁵ of {D cc⁵ => id_₀(p10_₁, cc⁵)}: 86
//│ ------------------
//│ case bb² of {D cc² => id_₂(p10_₃, cc²)}: 50 --->
//│ 	[D p20_₀]: 99
//│ case y² of {D bb² => case bb² of {D cc² => id_₂(p10_₃, cc²)}}: 51 --->
//│ 	[D [D p20_₀]]: 100
//│ case bb³ of {D cc³ => c1_₀(p12_₀, cc³)}: 62 --->
//│ 	[D [D p21_₀]]: 96
//│ case y³ of {D bb³ => case bb³ of {D cc³ => c1_₀(p12_₀, cc³)}}: 63 --->
//│ 	[D [D [D p21_₀]]]: 97
//│ case bb⁴ of {D cc⁴ => c1_₂(p12_₂, cc⁴)}: 76 --->
//│ 	[D [D [D p20_₀]]]: 101
//│ case y⁴ of {D bb⁴ => case bb⁴ of {D cc⁴ => c1_₂(p12_₂, cc⁴)}}: 77 --->
//│ 	[D p21_₁]: 90
//│ case bb⁵ of {D cc⁵ => id_₀(p10_₁, cc⁵)}: 86 --->
//│ 	[D [D [D p20_₁]]]: 128
//│ case y⁵ of {D bb⁵ => case bb⁵ of {D cc⁵ => id_₀(p10_₁, cc⁵)}}: 87 --->
//│ 	[D p21_₀]: 95
//│ case bb⁶ of {D cc⁶ => id_₁(p10_₂, cc⁶)}: 109 --->
//│ 	[D [D p21_₁]]: 91
//│ case y⁶ of {D bb⁶ => case bb⁶ of {D cc⁶ => id_₁(p10_₂, cc⁶)}}: 110 --->
//│ 	[D [D [D p21_₁]]]: 92
//│ case bb⁷ of {D cc⁷ => c1_₁(p12_₁, cc⁷)}: 121 --->
//│ 	[D p20_₁]: 126
//│ case y⁷ of {D bb⁷ => case bb⁷ of {D cc⁷ => c1_₁(p12_₁, cc⁷)}}: 122 --->
//│ 	[D [D p20_₁]]: 127
//│ <<<<<<< fusion matches <<<<<<<
//│ 
//│ >>>>>>> new fusion strategy >>>>>>>
//│ [D p21_₁]: 90 --->
//│ 	case y⁴ of {D bb⁴ => case bb⁴ of {D cc⁴ => c1_₂(p12_₂, cc⁴)}}: 77
//│ [D [D p21_₁]]: 91 --->
//│ 	case bb⁶ of {D cc⁶ => id_₁(p10_₂, cc⁶)}: 109
//│ [D [D [D p21_₁]]]: 92 --->
//│ 	case y⁶ of {D bb⁶ => case bb⁶ of {D cc⁶ => id_₁(p10_₂, cc⁶)}}: 110
//│ [D p21_₀]: 95 --->
//│ 	case y⁵ of {D bb⁵ => case bb⁵ of {D cc⁵ => id_₀(p10_₁, cc⁵)}}: 87
//│ [D [D p21_₀]]: 96 --->
//│ 	case bb³ of {D cc³ => c1_₀(p12_₀, cc³)}: 62
//│ [D [D [D p21_₀]]]: 97 --->
//│ 	case y³ of {D bb³ => case bb³ of {D cc³ => c1_₀(p12_₀, cc³)}}: 63
//│ [D p20_₀]: 99 --->
//│ 	case bb² of {D cc² => id_₂(p10_₃, cc²)}: 50
//│ [D [D p20_₀]]: 100 --->
//│ 	case y² of {D bb² => case bb² of {D cc² => id_₂(p10_₃, cc²)}}: 51
//│ [D [D [D p20_₀]]]: 101 --->
//│ 	case bb⁴ of {D cc⁴ => c1_₂(p12_₂, cc⁴)}: 76
//│ [D p20_₁]: 126 --->
//│ 	case bb⁷ of {D cc⁷ => c1_₁(p12_₁, cc⁷)}: 121
//│ [D [D p20_₁]]: 127 --->
//│ 	case y⁷ of {D bb⁷ => case bb⁷ of {D cc⁷ => c1_₁(p12_₁, cc⁷)}}: 122
//│ [D [D [D p20_₁]]]: 128 --->
//│ 	case bb⁵ of {D cc⁵ => id_₀(p10_₁, cc⁵)}: 86
//│ ------------------
//│ case bb² of {D cc² => id_₂(p10_₃, cc²)}: 50 --->
//│ 	[D p20_₀]: 99
//│ case y² of {D bb² => case bb² of {D cc² => id_₂(p10_₃, cc²)}}: 51 --->
//│ 	[D [D p20_₀]]: 100
//│ case bb³ of {D cc³ => c1_₀(p12_₀, cc³)}: 62 --->
//│ 	[D [D p21_₀]]: 96
//│ case y³ of {D bb³ => case bb³ of {D cc³ => c1_₀(p12_₀, cc³)}}: 63 --->
//│ 	[D [D [D p21_₀]]]: 97
//│ case bb⁴ of {D cc⁴ => c1_₂(p12_₂, cc⁴)}: 76 --->
//│ 	[D [D [D p20_₀]]]: 101
//│ case y⁴ of {D bb⁴ => case bb⁴ of {D cc⁴ => c1_₂(p12_₂, cc⁴)}}: 77 --->
//│ 	[D p21_₁]: 90
//│ case bb⁵ of {D cc⁵ => id_₀(p10_₁, cc⁵)}: 86 --->
//│ 	[D [D [D p20_₁]]]: 128
//│ case y⁵ of {D bb⁵ => case bb⁵ of {D cc⁵ => id_₀(p10_₁, cc⁵)}}: 87 --->
//│ 	[D p21_₀]: 95
//│ case bb⁶ of {D cc⁶ => id_₁(p10_₂, cc⁶)}: 109 --->
//│ 	[D [D p21_₁]]: 91
//│ case y⁶ of {D bb⁶ => case bb⁶ of {D cc⁶ => id_₁(p10_₂, cc⁶)}}: 110 --->
//│ 	[D [D [D p21_₁]]]: 92
//│ case bb⁷ of {D cc⁷ => c1_₁(p12_₁, cc⁷)}: 121 --->
//│ 	[D p20_₁]: 126
//│ case y⁷ of {D bb⁷ => case bb⁷ of {D cc⁷ => c1_₁(p12_₁, cc⁷)}}: 122 --->
//│ 	[D [D p20_₁]]: 127
//│ <<<<<<< new fusion strategy <<<<<<<
//│ 
//│ >>>>>>> after fusion >>>>>>>
//│ c0_₀(p10_₀, p20_₀)
//│ def c0_₀(x¹⁵) = 
//│ 	x¹⁵
//│ def p10_₀ = 
//│ 	p11_₀
//│ 	where
//│ 	def p11_₀(y⁹) = 
//│ 		y⁹(99)
//│ 		where
//│ 		def c1_₀(x¹⁴) = 
//│ 			x¹⁴
//│ 		def p12_₀(y¹⁰) = 
//│ 			y¹⁰(99)
//│ 			where
//│ 			def id_₀(x¹¹) = 
//│ 				x¹¹
//│ 			def p10_₁ = 
//│ 				p11_₁
//│ 				where
//│ 				def p11_₁(y¹³) = 
//│ 					y¹³(99)
//│ 					where
//│ 					def c1_₁(x¹⁶) = 
//│ 						x¹⁶
//│ 					def p12_₁(y¹¹) = 
//│ 						y¹¹(99)
//│ 						where
//│ 						def id_₁(x¹³) = 
//│ 							x¹³
//│ 						def p10_₂ = 
//│ 							p11_₂
//│ 							where
//│ 							def p11_₂(y⁸) = 
//│ 								y⁸(99)
//│ 								where
//│ 								def c1_₂(x¹⁰) = 
//│ 									x¹⁰
//│ 								def p12_₂(y¹²) = 
//│ 									y¹²(99)
//│ 									where
//│ 									def id_₂(x¹²) = 
//│ 										x¹²
//│ 									def p10_₃ = 
//│ 										p11_₀
//│ def p20_₀ = 
//│ 	let bb⁸ = 	
//│ 		let cc⁸ = 	
//│ 			let bb⁹ = p21_₀
//│ 			in (fun _lh_dummy² -> bb⁹(99))
//│ 		in (fun _lh_dummy¹ -> c1_₀(p12_₀, cc⁸))
//│ 	in (fun _lh_dummy⁰ -> bb⁸(99))
//│ 	where
//│ 	def p21_₀ = 
//│ 		let cc¹² = 	
//│ 			let bb¹³ = 	
//│ 				let cc¹³ = p20_₁
//│ 				in (fun _lh_dummy¹¹ -> c1_₁(p12_₁, cc¹³))
//│ 			in (fun _lh_dummy¹⁰ -> bb¹³(99))
//│ 		in (fun _lh_dummy⁹ -> id_₀(p10_₁, cc¹²))
//│ 		where
//│ 		def p20_₁ = 
//│ 			let bb¹⁰ = 	
//│ 				let cc⁹ = 	
//│ 					let bb¹¹ = p21_₁
//│ 					in (fun _lh_dummy⁵ -> bb¹¹(99))
//│ 				in (fun _lh_dummy⁴ -> id_₁(p10_₂, cc⁹))
//│ 			in (fun _lh_dummy³ -> bb¹⁰(99))
//│ 			where
//│ 			def p21_₁ = 
//│ 				let cc¹⁰ = 	
//│ 					let bb¹² = 	
//│ 						let cc¹¹ = p20_₀
//│ 						in (fun _lh_dummy⁸ -> id_₂(p10_₃, cc¹¹))
//│ 					in (fun _lh_dummy⁷ -> bb¹²(99))
//│ 				in (fun _lh_dummy⁶ -> c1_₂(p12_₂, cc¹⁰))
//│ <<<<<<< after fusion <<<<<<<
